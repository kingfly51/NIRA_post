<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wang Fei, Wu Yiming, Wu Yibo, Zhu Tingshao" />

<meta name="date" content="2025-05-25" />

<title>NIRApost Tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">NIRApost Tutorial</h1>
<h4 class="author">Wang Fei, Wu Yiming, Wu Yibo, Zhu Tingshao</h4>
<h4 class="date">2025-05-25</h4>


<div id="TOC">
<ul>
<li><a href="#nirapost-r-markdown" id="toc-nirapost-r-markdown">NIRApost
R Markdown</a></li>
<li><a href="#package-load" id="toc-package-load">Package Load</a></li>
<li><a href="#import-data-and-fit-ising-network" id="toc-import-data-and-fit-ising-network">Import data and fit Ising
network</a></li>
<li><a href="#simulated_alleviate_intervention" id="toc-simulated_alleviate_intervention">Simulated_alleviate_intervention</a></li>
<li><a href="#post-hoc-analysis-of-nira" id="toc-post-hoc-analysis-of-nira">Post hoc analysis of NIRA</a></li>
</ul>
</div>

<div id="nirapost-r-markdown" class="section level2">
<h2>NIRApost R Markdown</h2>
<p>This is an R Markdown document. NIRApost is an R package designed for
computerized simulation intervention in cross-sectional networks,
enabling:</p>
<p>Post-intervention permutation tests</p>
<p>Stability analysis</p>
<p>Moderation effect testing</p>
<p>Visualization</p>
<p>The package is typically used in conjunction with NodeIdentifyR. For
detailed usage guidelines, please refer to our tutorial article:</p>
<p>“Simulation Intervention for Cross-Sectional Network Models: An R
Tutorial”</p>
</div>
<div id="package-load" class="section level2">
<h2>Package Load</h2>
<p>Load the R package used in the example into the current workspace</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(NIRApost)<span class="co">#Load NIRApost Package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(bootnet)<span class="co">#Load bootnet Package</span></span></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## This is bootnet 1.6</code></pre>
<pre><code>## For questions and issues, please see github.com/SachaEpskamp/bootnet.</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(nodeIdentifyR)<span class="co">#load nodeIdentifyR Package </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)<span class="co">#Load dplyr Package</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
</div>
<div id="import-data-and-fit-ising-network" class="section level2">
<h2>Import data and fit Ising network</h2>
<p>We utilized the built-in dataset single_gds from the NIRApost package
to estimate an Ising network using the estimateNetwork function from the
bootnet package, implementing the more stringent “AND” rule for network
estimation. From this cross-sectional network, we extracted two critical
components for subsequent NIRA simulation studies:</p>
<p>Edge weight matrix of the entire Ising network, which contains:</p>
<p>Complete node information</p>
<p>Pairwise connection weights between all nodes</p>
<p>Threshold parameter vector derived from the intercept terms of each
node in the Ising model</p>
<p>These two components enable computerized network intervention
simulations in subsequent analyses.</p>
<p>Implementation code:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#data(package=&quot;NIRApost&quot;)#View the dataset stored in the NIRAspost package</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;single_gds&quot;</span>)<span class="co">#load data</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>gs_fit<span class="ot">&lt;-</span><span class="fu">estimateNetwork</span>(single_gds,<span class="at">default =</span> <span class="st">&quot;IsingFit&quot;</span>,<span class="at">rule=</span><span class="st">&quot;AND&quot;</span>)<span class="co">#Fit Ising model</span></span></code></pre></div>
<pre><code>## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet</code></pre>
<pre><code>##   |                                                                              |                                                                      |   0%  |                                                                              |==========                                                            |  14%  |                                                                              |====================                                                  |  29%  |                                                                              |==============================                                        |  43%  |                                                                              |========================================                              |  57%  |                                                                              |==================================================                    |  71%  |                                                                              |============================================================          |  86%  |                                                                              |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>edgeWeightMatrix<span class="ot">&lt;-</span>gs_fit<span class="sc">$</span>graph<span class="co">#Extract the weight matrix of edges</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>thresholdVector<span class="ot">&lt;-</span>gs_fit<span class="sc">$</span>intercepts<span class="co">#Extract the intercept term from logistic regression as the threshold parameter</span></span></code></pre></div>
</div>
<div id="simulated_alleviate_intervention" class="section level2">
<h2>Simulated_alleviate_intervention</h2>
<p>This section primarily utilizes four functions from the nodeIdentifyR
package to conduct computer-simulated alleviating interventions. If
users wish to perform simulated aggravating interventions, they simply
need to change the perturbation_type parameter in both the
simulateResponses function and the plotSumScores function from
“alleviating” to “aggravating.”</p>
<p>Specifically, the simulateResponses function first employs the edge
weight matrix (edgeWeightMatrix) and threshold parameter vector
(thresholdVector) extracted from the Ising network to simulate an
alleviating intervention that reduces the intercept of each node by two
standard deviations. Given that the edge weight matrix and threshold
parameter vector can be used to simulate responses for a group of
participants, the simulateResponses function essentially performs 7+1
rounds of response simulation. The 7 rounds represent sequentially
reducing the intercept of a specific node by two standard deviations
while keeping the intercepts of other nodes unchanged, along with the
edge weight matrix unchanged—meaning a simulated alleviating
intervention is applied to that node. 1 round represents directly using
the original weight matrix and threshold parameter vector to simulate a
new sample with a similar response pattern to the original sample. This
step ultimately generates 7+1 new simulated datasets, where the 7
datasets represent simulated responses for 5,000 participants under
sequential alleviating interventions targeting each node, and the
remaining one represents simulated responses for 5,000 participants
using the original weight matrix and threshold parameter vector.</p>
<p>After obtaining the output gs_IsingSamples from the simulateResponses
function, the next step is to input it into the calculateSumScores
function. This step primarily calculates the total sum scores for each
participant (i.e., 5,000 × 7) across all items in the 7+1 simulated
datasets. Specifically, since the previous step simulated each
participant’s responses on individual items, summing these scores yields
the total GDS score for each participant, which measures the severity of
their depressive symptoms.</p>
<p>Once the output gs_sumIsingSamples from the calculateSumScores
function is obtained, it is passed to the prepareDFforPlottingAndANOVA
function to transform the originally wide-format data into long-format
data, facilitating subsequent plotting.</p>
<p>Finally, the output gs_sumIsingSamplesLong from the
prepareDFforPlottingAndANOVA function is fed into the plotSumScores
function to generate a plot of the mean total scores for the 7+1
simulated datasets, sorted in ascending order (for “alleviating”) or
descending order (for “aggravating”). This allows for a comparison
between the mean total score of the original unperturbed dataset and
those of the datasets with simulated alleviating interventions targeting
individual nodes, thereby identifying the most influential node.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)<span class="co">#set seed</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>gs_IsingSamples<span class="ot">&lt;-</span><span class="fu">simulateResponses</span>(edgeWeightMatrix, thresholdVector, <span class="st">&quot;alleviating&quot;</span>, <span class="dv">2</span>)<span class="co">#Generate N+1 simulated samples, where N represents simulated alleviate intervention samples for N nodes and 1 represents simulated origin samples</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>gs_sumIsingSamples<span class="ot">&lt;-</span><span class="fu">calculateSumScores</span>(gs_IsingSamples)<span class="co">#Calculate the total score of each participant in each simulated sample</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>gs_sumIsingSamplesLong<span class="ot">&lt;-</span><span class="fu">prepareDFforPlottingAndANOVA</span>(gs_sumIsingSamples)<span class="co">#Convert the total score calculated from the previously generated origin simulation samples and the simulation intervention samples of each node into a long format for plotting purposes</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">plotSumScores</span>(<span class="at">sum_scores_long=</span>gs_sumIsingSamplesLong,<span class="at">perturbation_type=</span><span class="st">&quot;alleviating&quot;</span>)<span class="co">#Draw an average total score figure</span></span></code></pre></div>
<pre><code>## $sumScoresPlot</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA7VBMVEUAAAAzMzMzMzozM00zM1ozM38zWlozWqAzf38zf5Uzf6Azf8FBM01HVKBHkOFNM2dNoOFUM3NaMzNaM1paM39aVG1aWjNaWlpaWn9aWqBaf2daf3Naf8FakJBaoMFaoOFbM0dbrP9nM39/MzN/M1p/M39/WjN/Wlp/czN/fzN/f39/oKB/q6B/wcF/wf+QkFqVTTOgWjOgWk2gWlqgWn+goFqgoH+gwaCg4cGg4f+soFrBczPBfzPBoFrBwX/B4aDB/8HB/+HB///MzMzhoFrh4aDh/8Hh/+Hh////q1r/wX//4aD//8H//+H///8ilNBwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMrUlEQVR4nO2di5/bOBHHY9htgfDMlh7LK3dky6MHgVDuSsBwvcVXFjvx///noBk9LMm2xlGcbGLN73O3TfQYSd9II8mxlVnNCmr23BW4dDEgQgyIEAMixIAIMSBCMYCy0WtxwXIB7VbZy6d8SeRJF1B5sy1ePu1WBKFkAe03y1oAqovbx2CeZAHtVmsEVDKgRl09KBf/g8osu9nKqGqRZSo0YUDKBxXZGt9Vd1vTmcq5lSxdQDCLNb0GAx7kG2dmSxhQS4UcV/t3GloG+k8C6gIEPshRtVC9affw2upYyfYgmMU8KR8E7mj3Rs9tHqCZ0IlqdwFynXRrftc+yHnZ6kET5uP1oEyq4cSAAm2D/lTdP3kvawZkVMi+BFN8YXerhAHBgtlZB3UqXUBlBvO8Xkn3KllAeh1UmF1Xt5IFpNdBh+7mk1kHRfag2aRXiiP4oIQAxc1iKQEapmR90FAlO4vVeLFVOqKQ2oAmTMhpmrwYvVvNexIrJQsodh2UDCCzDmJAjZymyRVQtTj0m9VkAEXv5pMBNEzpXpMeqI5vNaZLyGkZ3NdRWN8x9yhdQGIdVC3mdX7oOigVQLAOKsVEFnF3RzqAcgEn4v6gNACJsbVbwR1mPMQaeU5aLIL2G4JPwoAGquvmhckSYkCEGBAhBkSIARFiQIT8ad67P6hTyQLab6htqlTnPYpTJUTco9ipZAG17nLtUbKA8GbWAUoY0CLaSScBiN6mSiULiJ10h0Zz0lMlNJqTTgFQx532nUoW0FAxIELJAuIh1qGOZlFfiyUPKOab1T5T16+uVkU+N58OoMiTF5IBFPPNao+pCahrFou4/cU3NR2NeH4QA9JKFRDe3VrG3MTZtjUdNY2qFusa75/CFyElCgiXhzk+5hw3i00cEB7MJS+6mjNxmuG234QeC/dtTUkWoLWiZB/YoVnl9q2dCQOS7sd6ZlWdRwH/VK96Djdp25qSXB9UwJCyv9xQrACOZBU8P2h2zgN+Tqw2oPJmC7dwKkeNMucHNYBAvecHTbELWW0qcZNRLeydhnZHDKhHigoD6tNBTjo1QPahQYOm+dQA2ecH7VYDForJAepT/yl4EyTEgAgxIEIMiBADIsSACDEgQuMCmiAhBkSIARFiQIQYECEGRIgBERoZ0PQIMSBCDIgQAyLEgAgxIEIMiNDYgCZHiAERYkCEGBAhBkSIARFiQIRGBzQ1QgyIEAMixIAIMSBCDIgQAyI0PqCJEWJAhBgQIQZEiAERYkCEGBChEwCaFiEGRIgBEWJAhBgQIQZEiAEROgWgSRFiQIQYECEGRCjUFjjBfd28NCcyMCAp/EU/dXhHaZ+5xICkStFl9ps1vs7ts8oZUCN1zP3+nX3wGwloSoSIpqjzg3YPr9VpXcHzg4wmcJDQMED6VFc4rWv3hjzcZCj2a1KwKYV9pOKA43GGWb0uBQ83cU4FZkC+rB+RsE/KYUBaOTrkNU7xRTbkeJwhVq9NJ9lqTIkQAyLEgAgxIEIMiBADIsSACJ0I0HQIMSBCDIgQAyLEgAgxIEIMiNCpAE2GEAMCzUA9URHmpgcoUF0GJMWACDEgQgyI0PkBXReh3kmMAaGeY5pnQGShEZafSwwoKMGGfVC/JJpnmMWug5DuOQyoU83AYkAdjth+y4Bqv0IuLQZUexWaBeIGRQQ0AUCtwfYM66ALBtS76AllOkADAV0cIT2jH1Sv5AAdhicpQDPcUhycK6Kk6wQUcMTBbBFFMSBCVwloxoBCAjRRfE4K6GIIKTJR1ZkWoK5h1IQwoI4yB+3YD7A3SNcDaOCOfbC9gboWQP5oY0B2mS1ndIHT/DMCiprRA/YO02BAz0BoJlc8IxqMyHPBgGLXywGLEXkuHdC4FiPyXC6g8TvQpADFb7hCRiPyXCagYzZcIbOBOOv8oP3moMfCh1gfV8dtuEKG+6Ps84PyOfynNBzQKQh1b0hPVmLAnnV+EBxLUb0afrjJEPPhfEFfEtiQnnWI1eb8IIBzyNkdg8wfBKE/zv8OcECtDhFhT50f1AAadn6QUfggoVDswLiZn26so4uGATLnB52iBx3QS/riRtqQhhQ0Z84PukxAY7M4uB7N+UEnctJHAToLnmA9rPODoqf5MKFIQHFfkUYqUI59ftBuFbVQDM9UkXEncDQBnXarERwIoYb6cTNfB1ThOD03oIFq5YuodpyeCRDVE4IQzsnnOQCZtsf6p/NeJIjIcwQgt2McvVA8g04NyCqgPWoYkBkq3S6FAdVhX8yAiCk5CsJ5Z/krBHRmnckH9URFxZ1XZ5zFrlMMiBADIsSACDEgQmeY5iNKuCCdvAdduxgQIQZEiAERYkCEGBAhBkSIARFiQIQYEKEoQCnoGEBtYtcRF5WNARFxDIiIu/KLEacXAyLEgAgxIEIMiNARgJr7gptXtbwZ9n/Zj+HliwWuuW7eL/AO0N1K3ghamWD4x/mtUhG3NAZL+2deIazSGSovp0wv/mLpZbZUFfEywKv9RvyrbthVBeggY2UkQN3Chxf++f05lLtUxVV3r9dQnxcuUlmV3PxMO0YgS4zZb97av1EOgHQGP6dpGpaev3VKbzKAcoxDw7oAHXQeQPKm/B/9Rt2ar0h8gZ/p512A3ArJpCr6KzvKALJf2OZ0xO7Nhzd26U2GWv+crg7HAkzQOIBEZxUds/rZb2/Bunj3vc0ajX+RQc8uobdWP/3J77b4OJVp6v2TqPhXQwB9/bdHGVbMnV9xHwQInk6q7v/7zi7dAaQ6D0oVYIJGAYRP2d0Kb7DW9SkyBCR8hwgXAfkvbv78q1f/WEL5hsTXUOV51QUot8cRhJVz82xIaQ2/ZojNWzmbpokWF/I/UzpmkD5ojrfEKxdkCtBBjaM6ApCqOjymAG0R9gUTqPudfpqj/O7D7//46t8vn/K1RUJUOV/7gLBCS9/+/t0WopVtB5DO4OdsAAm6otxSl24y2N1CAEFfbhWAQaP0IPUYIlhRPnGvhpgcGFClb4ux/QEdQQOouv/45tEHhOnXjn0M+yVg2ujP3AKkM/g5m6ZhOcoNWem8VsPH6RUggkYBpHuQ5GH1IBkgitn/9dMffCPG1Hv88WxNYvcg3ncNMXcul2HgzVVtmwdq9BCDDH5O6Wfxw8Ny93bpJgOoxAEET5qaAkzQqD5I8rB8kCImCvvLt34Inevt0iGRi57e7YPcaV6OvdtH5WAaN10Fpnl8uVvhVPkJ/LVLd6b5/QYyQc83BZigUWexZkR9B/uTCoB++/PsM0Alnyg3JJzP0Qa0W3mrHWjf7Qf1+F55a2UxGdo5c+2TZL+yS8cM0v9CKKQEnFYBKmgcQC01TyJOUscBAhdRutPi1HRkDyqy7GbSHYh385QYECEGRIgBEYoDBNu7jJ69yvUga4W/IbO2SOtWmLbsvKcjOs04AWpl7iWIAiSXYTk1f4VraiVbtoPaOX1YndZ7I/pN+4A8RQHK1QW5eTjZYECtZFcOyCKDqAqxkv+TGHRLeWRVdQcXm5e4sRcL+FJfobCSqBplOtnto7KKfTN/+XH1OaaTlS9w071TYbW8imHSyHjZCZ2I3cOXYFjH4m5jbZlRFcMyYD33pTXEVOJIQMK0JlTiZfB1tRDGC6wOXEwTpkvdPPkCLllZSZQVGaM/QthBFsLyfrPcrSDxzVZWXrwWw1CH6UaY9/C/vNbvRuxWuAlVsXjVQxRpstnF56JKZdbY1oljAZlPXVq722L91J+1rKxoLkTitXPovU4SsGFiNCDo4vlbsam+26JbEulke3Xbm7wmHNMsa7OpbUWYWL0j0rF28dJq3gCytk/R07zYt4NBMcbgQgFelFJ/ZHGq5fKNDm3+1E2MNWXtHt7jJRMMgvfGgur6Kq1xNeKPdB0OuSZzbWL1d0461i5e8ijt3mkIHbMOwo55+5gvaxcQXuRyAOkKtQHphqC9ZXX/8WGbz5026mtmvYAycyWjC5CJxSuIaw+QTFb4gHTiSED6MwWLu4e/w9lCBKBBPUh0xX/N6/zXG7eNw3qQUk8P0srVgKZ6kE4cCUjPYtJDfwKXmtwhhlf2Wj7IA9TyQXX16g/Lunhxt3Xa2PigbkDOvN2KcGd1K7TtgwoPkHwROYvB/CC/4S2yZe0DMnPE0p7FPECtWUxOP2jbaSNUXHwmLqBlAwwbZjzs0iOnY7F/lE0PcoqXs5rlpFXiWEA1bjWkPRxQHiC90siddZAPyFmIoHL8Fn1Z+21U66AGEFj+aN4X1r7HilBpdWwpq9yYCa2DStO+Y5w0qrp/8kO8b3KuW0cDKlobKQZkqVq89DsQA0pLDIgQAyLEgAgxIEIMiBADIvR/HWtiQ2xwOrUAAAAASUVORK5CYII=" /><!-- --></p>
<pre><code>## 
## $plottedInformation
##    thresholdIteration meanSumscore  ciLower  ciUpper
##                &lt;char&gt;        &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
## 1:           original       3.4036 3.325365 3.481835
## 2:                WTM       1.8910 1.824408 1.957592
## 3:                 TR       1.9420 1.876404 2.007596
## 4:                 NA       1.9442 1.875436 2.012964
## 5:                IRR       1.9548 1.888504 2.021096
## 6:                 UW       2.0596 1.993704 2.125496
## 7:                RES       2.1564 2.089552 2.223248
## 8:                ASH       2.2720 2.205218 2.338782</code></pre>
</div>
<div id="post-hoc-analysis-of-nira" class="section level2">
<h2>Post hoc analysis of NIRA</h2>
<p>In general, NIRA (NodeIdentifyR Algorithm) would typically conclude
after completing the aforementioned steps. However, in our view, this is
far from sufficient. Therefore, we propose three additional validation
tests to ensure the reliability of NIRA results. These three tests are:
permutation testing, stability testing, and moderation effect testing.
Since these components represent the core aspects we aim to emphasize,
we will elaborate on each of them separately in the following
sections.</p>
<p>##Permutation Test</p>
<p>First, we will elaborate in detail on the permutation test. Although
researchers commonly rely on visual inspection of the plotSumScores
output to determine whether there is a difference between the mean total
score of a simulated intervention on a specific node and that of the
original simulated sample, this approach may lead to four key
issues.</p>
<p>First, it fails to provide convincing statistical evidence to confirm
whether the simulated intervention truly had an effect. Second, while
the error bars in the plotSumScores plot represent 95% confidence
intervals (CIs), users might attempt to assess significance by checking
whether the error bars of the original simulated sample’s mean total
score overlap with those of the intervention sample. However, when the
means are far apart or the error bars are near the threshold of overlap,
visual inspection alone becomes unreliable for determining significance.
Third, the significance level is often influenced by the intervention
strength (i.e., the number of standard deviations shifted). For
instance, when applying a 2-SD intervention, the difference between the
original and intervention sample means is typically large and easily
discernible. However, if researchers examine smaller intervention
effects, visual assessment becomes highly problematic. Finally, the
plotSumScores output does not account for multiple comparisons, leading
to alpha inflation. Thus, significance testing requires correction for
false positives, which is particularly crucial in networks with a larger
number of nodes.</p>
<p>Having established the necessity of permutation testing, we now
describe how NIRApost implements this procedure. Specifically, NIRApost
conducts permutation testing using three core functions:
permutation_test(), getstat(), and plotmeanNIRA().</p>
<p>permutation_test(): This function evaluates the statistical
significance of the difference in distributions between the original
sample scores (specified via the original parameter, consisting of 5,000
simulated total scores) and the post-intervention sample scores
(specified via the group parameter, consisting of 5,000 total scores
generated under specific node-based interventions). The significance is
assessed using a permutation test (with the number of permutations set
to n_perm = 5000 by default). getstat(): Building upon the permutation
test, this function integrates multiple comparison correction methods
(specified via the method parameter). It enables batch processing of
intervention effect assessments across all nodes and outputs
statistically significant results after correction. plotmeanNIRA():
Designed specifically for result visualization, this function generates
intuitive significance maps (e.g., see Figure 9) by taking the
statistical output from getstat() (passed via the statresult parameter)
and specifying the type of intervention (via the perturbation_type
parameter, with options “aggravating” or “alleviating”).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>stat_result<span class="ot">&lt;-</span><span class="fu">getstat</span>(gs_sumIsingSamplesLong,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)<span class="co">#Perform permutation test and extract statistical measures, and use Bonferroni for multiple comparison correction</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">head</span>(stat_result<span class="sc">$</span>stat)<span class="co">#View statistics</span></span></code></pre></div>
<pre><code>##     mean_other sd_other   se_other   ci_other ciLower_other ciUpper_other
## ASH     2.2720 2.408729 0.03406458 0.06676657      2.205233      2.338767
## RES     2.1564 2.411120 0.03409839 0.06683285      2.089567      2.223233
## UW      2.0596 2.376800 0.03361303 0.06588153      1.993718      2.125482
## IRR     1.9548 2.391213 0.03381686 0.06628105      1.888519      2.021081
## NA      1.9442 2.480225 0.03507568 0.06874833      1.875452      2.012948
## TR      1.9420 2.365958 0.03345969 0.06558100      1.876419      2.007581
##       cohen_d          p   p.adjust
## ASH 0.4313452 0.00019996 0.00139972
## RES 0.4752109 0.00019996 0.00139972
## UW  0.5151756 0.00019996 0.00139972
## IRR 0.5539504 0.00019996 0.00139972
## NA  0.5493650 0.00019996 0.00139972
## TR  0.5613147 0.00019996 0.00139972</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plotmeanNIRA</span>(stat_result,<span class="st">&quot;alleviating&quot;</span>)<span class="co">#Visualize Mean Values with Confidence Intervals from NIRA Analysis,Please note,The &#39;alleviating&#39; needs to be consistent with the perturbation_type mentioned earlier</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAB0VBMVEUAAAAAADoAAGYAHWUANYQAOjoAOmYAOpAAZrYQHSgQNIAcXZscXbQncLQyXZs1Xqg6AAA6OgA6Ojo6OmY6OpA6ZpA6ZrY6kJA6kNs8grRGgptGgrRNTU1NTW5NTY5Nbm5Nbo5NbqtNjshmAABmADpmOgBmOjpmZgBmZmZmZpBmkJBmkLZmkNtmtrZmtttmtv9uTU1uTW5ubk1ubo5ubqtujm5ujo5ujqtujshuq8huq+SOTU2Obk2Obm6Ojm6Oq6uOq8iOq+SOyOSOyP+QOgCQOjqQZjqQkGaQkLaQkNuQtraQttuQ27aQ2/+oXjWoqMmrbk2rbm6rjk2rjm6rjo6rjqurq6uryMiryOSr5P+2ZgC2Zjq2kDq2kGa2kJC2kLa2tra2ttu225C229u22/+2/7a2///Ijk3Ijm7Iq27Iq47IyKvIyMjIyOTI5KvI5OTI5P/I///JhDXJ6+vbkDrbkGbbtmbbtpDbtrbbttvb27bb29vb2//b///kq27kq47kyI7kyKvkyMjk5Kvk5Mjk5OTk5P/k/+Tk///rqITrycnr6+v/Y0f/tmb/tpD/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T///80dca/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOjElEQVR4nO2d+2MURx3AN9FCfTYFW9FseCQtoq1wAiJNaAWCUEWUilqBouCDS9sIqYBWCumBgFHAAy4kd/vXOo/dvdnd78x39pHc3u7380PvymR35j43852Z29kdxyOMOIMuQNkhQQgkCIEEIZAgBBKEQIIQSBACCUIgQQgkCIEEIZAgBBKEQIIQSBACCUIgQQgkCIEEIZAgBBKEQIIQSBACCUIgQQgkCIEEIZAgBBKEQIIQSBBC0YIeliwx+1l9SBACCUIgQQgmQZ833O0L8m3bdd2Jsxbnq5OgTmNydWbHkni/aGUnV4GGTxCjd3rrJ+orTs0ELc9MitfVGdbCjlqcrmaCVmf8GNRpHOw1w1b2sA5YCfK8vhUWp6cthNerBkWsQIJ2CYop0LAKmu2/nYb+Ylf0f+skqOVO95pbP+E9WFu+hf6qxoJ6H4qBouji+ZgRHAk92vWooAINnyALHj1igh6pikhQBBJk5pEvSDFEglRIEAIJwqAYhECCUGgchLFr3D7PmgqKGCJBcUiQCfq5wwKqQQgkCCNiiAQlIUEIJAiBBCXOG2V8fCAXrtaYPILiqFWIahAACUIgQQgkCIEEYSiGSBAECUIgQQgkCIEEYfQNVV7QZ/+8bXFUnNoIujHmjP7ltTctjotSF0HXHYcJmnK2WBwYoSaCusdGfj41evmGszFtM6uJoJUpVn1GL7OXyxZHRggNVVyQqEGP09egmggSMch52Ukfg+oiqHueG3JeSd/T10SQ5z27ePHireB/lPvFOofCtyC1EaSi3C/WOz3579P+rWMwgaFKC1rZuUmyOejFgvvEOo1p5J66egiaciRhNx/cL8Zv2VBu2wCohaDupywCXTwxNnLSj9Lh/WKLQtB0cF6Ayl0cgwT5PBl7MXzv3y8WFQRRixrko46kfSt4EwsMVVvQs88YN487qqBZ+YIF6VoICoO0bGLK/WJ4N18rQf5IWr1fDBso1kNQLqovSAQgyS3DAVqkoeoKCgOQOlBMAwlCqLqg3NRJ0DOLAxPUQVD3uJjMj2VqYtJQtQWdyxODaiCIxelvTo18/1g2P7UQNHr53MgpdTafhjoIGjl13dmS5boYp/qCWAwa/eNY5hgkDFVbUPc8a2NOlutiguoLEnx68U8Wx0FUW1D3D5mmqCrVFsT6+BfeyLJ4qk/lBTHyOWKGqivI856e4D2Ys+FkZkcVF8R4dkE4+oZZkfZaUpUujsGCGE+PZx4H1aAG+c2MBPVRBd08LhrYyBuZO3zWxjIXqOyCusednHa8agvi3Xw+O17FBe3Ma8ertqBCIEEY0SedxCFBJAiDBCFUXFD3QmyVa2oqLijfdTGB0dCwC2JjxQ3v8oWul7L/KFRxQTmqjk+lBXnnRk5ZHGKk2oKeTG04mXmFmaTSgpK3IqTnockQCaq4oBi9uf5eEfb7i9VCkFxh1nKPhHv72O8vVmlByRVm/q0IKfYXq7Sg5Ei6KQWl2V/MYGjYBSVXmLX9wJNmf7GKXByDBcVWmHUa7mSYaru/WKVrUHSFGfOjhB4SFF9h1jsd6dlJUHyFGRv78AiN7C+WzFNvaOgFCcIVZk2XM23eXwzIs9qCsj2BKpJnlQVlfQJVJM8KC8r8BKpInsMoaGVqj/KiUswTqKJ5ag2VVVD31sprp7q3/Jfo3xT0BKpInkMn6MnYC5s2OS/6L9G/KegJVJE8h06Q9+y8s/HS7eAlQkFPoIrkOXyCVqa+N7Y7fIlQ0BOoInkOn6D/vepdf/V28BLB9ASqLIg8dYZKK8hAfwmeeDaOJMeFw6EVlNzoSlLcbeFKnsMoyEtsWy2JCNoUf0RXeqotyNn8s3wzsaEWFN/PUqI8u+PC62Id8CvZ79UI89QYGqggYDahHpjcEVUS7cVunni5iBhUQkHgbCK9IH+1fQUFgbMJ5UBgV2aJKujZ73eKTmzzT3N28yUUBM4mUgnq/kTKeTffcvLSCoJmE/0Dx3FBrBcb+e4lqwcsWVxVKt/Fsf+89PBvL10LXiKMc3xB4T9CggobKOqqUBm7+XEJHqRrICgxm3jo65H/h42DiqHMgrzYYFm1k0gMqK+gmB50sloQQYFAQ2stCBksK61I2kn1c0dBDFCQ9WA5iMvpfg8qiAEKwgbLgaB+06qZIOvBst0uKT5VEmQeLAOziUEKAg2tsSDop3elPCRInzauziYsz+pTMUHAYLk/4CFBAmCwHBYlNpuopSDFQcwOJzpUHqggyNDaDJZjPZXfinw5yGQVZzCCjB/TkAivU0kK6led7N+JzyAEGT+mMRFep9LPsz8WzL8Zk88gBBk/ptkBuE4FEASUx1hYPQNpYsaPaUwE16n0R+/rK0i9XwzfNiKZZ9KQ1cc0JoLrVB7K3NKPBXMKUu4Xs9h4JJ7nytRXxz1NHNZ/TCxRk2fYoa+rII5/vxi+v1gsTx5jv/ZtQ3ejPZKT/HXPlBgd7qQZCxYgqBns7YNufhTNk8fYLxm6G7MDL/H7sD4xMRhMMRbMLyi4XwzfXyzOf3/hfOHr1/jLF395Df6TXabjTYmskqhXtNRLcNK7TQExrASF94vh+4sFqKH2K+OaUCuIX2WxTQzDjNUvp2tag/r3i6VuYiLGfvlb+lCbvE6XMlFpWoMSpNwvZrG/GJBnop8vQlBysDwwQcr9Yhm6eXMcVj5mErtEu8+5loLU+8WyDBRZDdL1RZYOSi4oE1iotfmYZgfGxmkuT6pEnzUUFPskajUoIEjDiabypEz0WQ9BUTWxROORUCIyQNCXJ2Wiz9oJikeSeIGyjoM8ZJhtn1YaQZoCWc8moonYJMV01jSJPusgCCxQrrmYNs90aaWJQXYFylxJaiiowMQyC0rX3dRSUGGRpJqCCowk1RRUikQShCSSICSRBCGJJAhJJEFIIglCEgciqIjLTqUnj6BaQYIQSBACCUIgQQgkCIEEIZAghCoKatms07Elv6AHBZSiUDoN7TqUO2/vs1qCoZBbUGvC8H21TGuKevM262kyHLmoWws357qu/sn8cGFzC+o09Ibaps04Wg1Xf+R9U5bGI+8ueb3TcK5t962l+959ndxFsLD5m5jB0OrMtobOUMvd/k5D9wzvljtxVFtJ0COZiUkgqceXgDG57kHNiUFDBQRpg6FF98caQy2XlVb7kHOxdusgHN3wI7dfbULrKVnF+u0h1z2wF0oUVXYOMJRbUO/uAmyoxeIh+9KugIaa/FOuzkxq6jtrDPyr3n4VOK35yNWZHR813APJGtY6Kvbf+dECuFy3xWNTuwGEhLyCltl3chQy1BSlYYXpAIZaPFquHuL1ZOIA4E+uiwT3E+o09EfeOSpWLC+f4UsH4zkyr8/neaVcBGoQP2uL9X7JVpZTEPvCrsy4s/xWhXiB3IkfNiYO/2riLJS4418Nd+/E4Y/f2Zv4OltbF8Sy2jn3rXtvxxNZ/9XRHslSti+szrDKc+dQLFH44cf/Zv5MIkDxzp8dK/4k0QPmFNRmn/8HzP7z2L8LBRPv869y0ksmsu+QlShWlOCULjPE98oBkkX/pT3SY1Vn4nBLpEa7QeGnvX9JdPQHY41Tdv7srEe8xIG5BC2/t+9se//900CJfQUTZ9lXmWglLXcbb5K8VoPnFYYWob7G77/gI0XNY/lt2wvkyP2IGnJvPj5SDDp/TXmyC+Ixgn3ORVbgfb+LF8hXMHG299GR2HHLMzuW2jpDIvRyQ9BwOOy/wM+yyL16vQ9FpY0iIozwMw98jKDzhw1lFtS7s3+JB+dFd1u8/igKoB7s+RLvMERy7EARuQ68/6DFPmuyp1b6r+SRXmCIdxuJxCDCNJMKlM4fPGtWQaz+TIoh0NEz8UbdmjUoCBDJ8eAkPohk68fxmhfpv2JVVkYO3xA0DJe1owkFL6XzT5THyyjogcxy1oMMBI0DVtAvF1i7uPG7v96b7KZ5nvr+qyVrxqILjB/lxI0bAv14hs6fk0WQnJ/KwQ9gIOgpYQUh7UQV8cKzevf+Gs9Tfh2a/isIH8A0NZi48cqZSPTrGtj5+2QR1Nl/f8HTTDHUuSKsADs5PHFp+xVW0/P5CZ1G/GP2J25AZQ+mfFDnH5Cpia02/C8FzFIzV7Qlj6FEO1EnbsnKHk75kp1/SBZBvaYrqy2cpWauaI0msrd1QS84yt33dvybQSZuhilfSAZBy+/xvgaewWvnigUgDWnDfudQsp2YJm6eccoXkl4QG1ldvdOADBnmioUgDel5nqwn+o5PnlEz5VNIL0hUcqhPMMwVC6KtHVZp0U/cOJopn0oqQQ9klqJdu26iWmrnioWhH1Zp0YZ1ATjli5BGkP/7fJNFtbmtV6BrB/BccbAYDRmugPikEeSPf3pz8lZW8HdfaK44YPTzHS98tISeVE2MDQHF6Zbnr96d01QUaK44YEwNs4MNZtMF6WAQx2+pz3bJZuhIIWj10Gxo6N586S6orhH2gnotvl+46TphJbEWJH8AQkJeBbEV1Lsz4w/IM4xFhhlLQf6EplwjnHXBUlBz64KYw9fPkJ2g1ZlpeRljek0LU0ZsBYlrAjuqNcSxwraJuTuutmpYf6wF9c4YfratNNbjoGX9z7aVpoqrXAuFBCGQIAQShECCEEgQAglCIEEIJAiBBCGUT9DKlHyE+bn+k8xDHufZ4TQbpRTk8I0CSJAGLohrIEEaxJbBWwJBT153nA0n+b/fGHM2XBCC2LuRN9erOKUUtMsZOSUFPZZ7K+/2vOvhLsvnxJst61ScUgrafczZeJsL4gH7dvcDpkW+O8bePRkb/bPH/rNOba2UgvY8GXP2cEHSg/wX/o7HIL9SOXvwUxVBOQWxZjT6HSZIBmVWcbbId1zTdRLEPruI1NEaxMKSEHadNb91LE5JBYnonIhBT2UMYjH77+vW35dVEGtWSi+2h3qxPlIQa11iHPSP5Dio+0G9x0ElgwQhkCAEEoRAghBIEAIJQiBBCCQIgQQh/B9AkV4YUBIx6AAAAABJRU5ErkJggg==" /><!-- --></p>
<p>##Stability Test</p>
<p>Why Stability Testing is Necessary? In practice, we have observed
that relying on a single simulation run—and reporting its results as
final findings in a study—may introduce substantial bias. For instance,
while initial simulations might identify WTM as the optimal node for
alleviating interventions, changing the random seed could lead to a
different “best” node. This raises critical concerns about the stability
of the simulation process. Only results derived from a highly stable
procedure can be deemed reliable. If the conclusions fluctuate
unpredictably with different random seeds, the entire NIRA framework
loses its validity.</p>
<p>Having established the necessity of stability testing, we provide
three functions in NIRApost to evaluate and visualize the stability of
NIRA results. Specifically:</p>
<p>The BootNIRAresult() function invokes the simulateResponses function
from the NodeIdentifyR package, which is designed for simulating
interventions. By utilizing the original threshold parameter vector
(thresholds parameter) and edge weight matrix (edge_weights parameter)
extracted from the Ising network, along with specifying the intervention
type (perturbation_type parameter, either “aggravating” or
“alleviating”) and intervention intensity
(amount_of_SDs_perturbation parameter, defaulting to 2 standard
deviations), the function simulates both the original sample and the
samples subjected to simulated interventions on each node. The ability
of BootNIRAresult() to repeatedly simulate the original sample stems
from its fifth parameter, nboots, which determines the number of
iterations for repeated simulations. This process generates a large
number of sample pairs (i.e., n simulated intervention samples and one
simulated original sample) through nboots repetitions. Given the
substantial time cost associated with serial computation,
the BootNIRAresult() function also offers an option for parallel
processing. The sixth parameter, parallel, when set to TRUE, enables
parallel computing, with the seventh parameter, ncores, specifying the
number of cores used. If serial computation is preferred, ncores should
be set to NULL.</p>
<p>After obtaining 1,000 repeated simulated sample pairs using
the BootNIRAresult() function, the next step involves computing
stability metrics based on these pairs. The findmaxn() function analyzes
the differences in network intervention effects generated during the
repeated simulation process, identifying which nodes exhibit the most
significant differences compared to the original network across multiple
simulations and calculating their frequency and relative proportions.
Specifically, the findmaxn() function takes two parameters: the
first, Bootresult, inputs the output of BootNIRAresult(), while the
second, n, specifies the top-n largest differences to consider
(defaulting to 3). This function examines the frequency of intervention
effects for each node at the 1st, 2nd, …, n-th largest difference
positions. For example, if n is set to 3, the function will only compute
the frequency of each node appearing among the top three positions in
terms of intervention effect magnitude. Observing these frequencies
reveals the stability of a node’s intervention effect in NIRA.</p>
<p>Building on this, the plotmaxn() function is specifically designed to
visualize the results of the findmaxn() analysis, providing an intuitive
representation of node intervention effect stability. By inputting the
output of findmaxn() into the first parameter, maxn, users can flexibly
control the range of difference levels displayed using
the low and high parameters, which support any reasonable range setting.
For instance, to visualize the frequencies of nodes ranked from top 1 to
top 5, users need only set low to 1 and high to 5.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)<span class="co">#set seed</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#parallel code</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>Bootresult<span class="ot">&lt;-</span><span class="fu">BootNIRAresult</span>(edgeWeightMatrix,thresholdVector,<span class="st">&quot;alleviating&quot;</span>,<span class="dv">2</span>,<span class="dv">100</span>,<span class="at">parallel =</span> <span class="cn">TRUE</span>, <span class="at">ncores =</span> <span class="dv">6</span>)<span class="co">#Perform parallel and repeated simulation interventions with 6 cores for 100 times. For demonstration purposes, only 100 times will be repeated here</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#serial code</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#Bootresult&lt;-BootNIRAresult(edgeWeightMatrix,thresholdVector,&quot;alleviating&quot;,2,100,parallel = FALSE, ncores = NULL)#It is worth noting that serial has a timeline, but parallel does not</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>repeat_node <span class="ot">&lt;-</span> <span class="fu">findmaxn</span>(Bootresult,<span class="at">n=</span><span class="dv">7</span>)<span class="co">#Extract the percentage and frequency of each node appearing in the top n absolute mean difference rankings between post-intervention simulated samples and the original simulated sample.</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="fu">plotmaxn</span>(repeat_node,<span class="at">low=</span><span class="dv">1</span>,<span class="at">high=</span><span class="dv">7</span>)<span class="co">#Generate stability plots of node ranking orders.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>##Moderation Effect Test</p>
<p>Moderation effect testing is essential for NIRA (Node-Specific
Intervention Robustness Assessment). This necessity arises from the
fundamental structure of NIRA’s simulation process:</p>
<p>Original Sample Simulation: Generated directly using the original
edge weight matrix and threshold parameter vector.</p>
<p>Intervention Sample Simulation: Generated using the original edge
weight matrix but with modified threshold parameters (i.e., perturbed
node intercepts).</p>
<p>This framework introduces a critical question: When altering a node’s
intercept, do the edge weights between other nodes remain unchanged?
This is precisely the issue of moderation effects. If such effects exist
(e.g., node A moderates the relationship between nodes B and C), then
reducing node A’s intercept (making it more likely to be 0) would
inherently alter the B–C interaction. In such cases, continuing to use
the original weight matrix for post-intervention simulations becomes
theoretically inappropriate.</p>
<p>Thus, testing for moderation effects constitutes a core prerequisite
for NIRA. Only when the network exhibits minimal or no moderation
effects can the intervention results be considered reliable.</p>
<p>To address this, NIRApost provides a dedicated function that:</p>
<p>1)Leverages the mgm package to construct moderated network models
(via mgm()).</p>
<p>2)Employs resampling techniques (resample()) to assess result
stability.</p>
<p>3)Repeats this process node-wise to quantify moderation effects
across the entire network.</p>
<p>we developed a function named run_mgmm_analysis() to implement this
functionality. This function primarily employs the mgm function from
the mgm package to construct a moderated network analysis and performs
repeated resampling via resample to assess the stability of the
moderating effects. A more detailed procedure involves iteratively
treating each node in the network as a moderator variable, testing its
moderating effect on every pairwise interaction between the remaining
nodes. This process is repeated for every node in the network. Finally,
resampling is conducted to generate as many samples as possible to
evaluate the stability of the moderating effects. Only those moderating
effects that pass the stability test are considered statistically
reliable. Specifically, the run_mgmm_analysis() function takes five
parameters: The first parameter, data, is used to input the dataset for
network construction. The second parameter, plot_results, is a logical
argument. When set to TRUE, the function exports all moderated network
graphs to the current working directory; no output is generated when set
to FALSE. The third and fourth parameters are used in the construction
of the moderated network analysis. The rule parameter specifies whether
the “OR” or “AND” rule is applied when building the moderated network,
consistent with the rules introduced in the Ising network.
The lambdaGam parameter represents the hyperparameter for EBIC (Extended
Bayesian Information Criterion), which is used by default for parameter
selection, with a default value of 0.25. The final parameter, nB,
defines the number of resampling iterations. Given that the stability
test for moderating effects across the entire network can be extremely
time-consuming, especially when the number of nodes is large, the
default resampling count is set to 100. Upon execution,
the run_mgmm_analysis() function returns a list containing the
statistically significant moderating effects in the network. If an empty
list is returned, it indicates that no stable moderating effects were
detected in the network.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>sig_moder<span class="ot">&lt;-</span><span class="fu">run_mgmm_analysis</span>(<span class="at">data=</span><span class="fu">as.matrix</span>(single_gds), <span class="at">plot_results =</span> <span class="cn">FALSE</span>,<span class="at">rule =</span> <span class="st">&quot;AND&quot;</span>, <span class="at">lambdaGam =</span> <span class="fl">0.25</span>, <span class="at">nB =</span> <span class="dv">10</span>)<span class="co">#Iteratively calculate the moderation effect of each node in the network.The purpose of the demonstration is to set nB to 10</span></span></code></pre></div>
<pre><code>## 
## ------ Running analysis with Moderator 1 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 2 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 3 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 4 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 5 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 6 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%
## ------ Running analysis with Moderator 7 ------
##   |                                                                              |                                                                      |   0%  |                                                                              |----------                                                            |  14%  |                                                                              |--------------------                                                  |  29%  |                                                                              |------------------------------                                        |  43%  |                                                                              |----------------------------------------                              |  57%  |                                                                              |--------------------------------------------------                    |  71%  |                                                                              |------------------------------------------------------------          |  86%  |                                                                              |----------------------------------------------------------------------| 100%
## Note that the sign of parameter estimates is stored separately; see ?mgm  |                                                                              |                                                                      |   0%  |                                                                              |-------                                                               |  10%  |                                                                              |--------------                                                        |  20%  |                                                                              |---------------------                                                 |  30%  |                                                                              |----------------------------                                          |  40%  |                                                                              |-----------------------------------                                   |  50%  |                                                                              |------------------------------------------                            |  60%  |                                                                              |-------------------------------------------------                     |  70%  |                                                                              |--------------------------------------------------------              |  80%  |                                                                              |---------------------------------------------------------------       |  90%  |                                                                              |----------------------------------------------------------------------| 100%</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">print</span>(sig_moder<span class="sc">$</span>significant_moderators)<span class="co">#Print the results of significant moderation effects</span></span></code></pre></div>
<pre><code>## $Moderator_2
## $Moderator_2$node
## [1] 2
## 
## $Moderator_2$significant_edges
## [1] 17
## 
## $Moderator_2$interaction_details
##   Variable A   Variable B         Mean      qtl_low     qtl_high      propLtZ 
##         6.00         7.00         0.17         0.00         0.25         0.80 
##         &lt;NA&gt;         &lt;NA&gt;     Mod_Mean  Mod_qtl_low Mod_qtl_high  Mod_propLtZ 
##         6.00         7.00         0.45         0.32         0.63         1.00 
## 
## 
## $Moderator_6
## $Moderator_6$node
## [1] 6
## 
## $Moderator_6$significant_edges
## [1] 21
## 
## $Moderator_6$interaction_details
##   Variable A   Variable B         Mean      qtl_low     qtl_high      propLtZ 
##         2.00         7.00         0.04         0.00         0.19         0.20 
##         &lt;NA&gt;         &lt;NA&gt;     Mod_Mean  Mod_qtl_low Mod_qtl_high  Mod_propLtZ 
##         2.00         7.00         0.46         0.34         0.69         1.00</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
