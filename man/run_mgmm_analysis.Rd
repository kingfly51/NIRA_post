% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_mgmm_analysis.R
\name{run_mgmm_analysis}
\alias{run_mgmm_analysis}
\title{Moderated Graphical Model Analysis}
\usage{
run_mgmm_analysis(
  data,
  plot_results = FALSE,
  rule = "AND",
  lambdaGam = 0.25,
  nB = 100
)
}
\arguments{
\item{data}{Numeric matrix or data frame (n × p) where:
\itemize{
\item Rows: Observations
\item Columns: Variables (nodes)
}}

\item{plot_results}{Logical indicating whether to save diagnostic plots for each moderator (default: \code{FALSE})}

\item{rule}{Regularization rule for edge selection:
\itemize{
\item \code{"AND"} (default): More conservative, both directions must be significant
\item \code{"OR"}: More inclusive, either direction significant
}}

\item{lambdaGam}{EBIC tuning parameter (default: 0.25). Values:
\itemize{
\item 0: BIC-like penalty
\item 1: EBIC with full penalty
}}

\item{nB}{Number of bootstrap samples (default: 100). For stable results:
\itemize{
\item ≥100 for exploratory analysis
\item ≥1000 for publication
}}
}
\value{
A list containing:

\strong{1. Full Results (\code{all_results})}
List of length p (number of nodes), each element contains:
\itemize{
\item \code{model}: Fitted mgm object
\item \code{interactions}: Detected interaction effects
\item \code{bootstrap}: Bootstrap results object
\item \code{table}: Summary table of edge weights and CIs
}

\strong{2. Significant Moderators (\code{significant_moderators})}
Filtered list where each element contains:
\itemize{
\item \code{node}: Moderator index
\item \code{significant_edges}: Indices of significantly moderated edges
\item \code{interaction_details}: Statistical details for significant interactions
}
}
\description{
Performs comprehensive moderated network analysis using Mixed Graphical Models (MGMM),
identifying significant moderator variables and their interaction effects through
bootstrap validation.
}
\section{Algorithm Workflow}{

\enumerate{
\item \strong{Model Fitting}:
\itemize{
\item Estimates separate MGMs with each node as moderator
\item Uses EBIC for sparse selection
}
\item \strong{Bootstrap Validation}:
\itemize{
\item Case resampling (nB iterations)
\item Computes 95\% CIs for edge weights
}
\item \strong{Significance Testing}:
\itemize{
\item Identifies edges where CI doesn't span zero
}
}
}

\examples{
```r
# Simulate binary data
set.seed(123)
dat <- matrix(rbinom(100*10, 1, 0.5), ncol = 10)

# Run analysis (minimal example)
results <- run_mgmm_analysis(dat, nB = 50)

# Extract significant moderators
sig_mods <- results$significant_moderators
if(length(sig_mods) > 0) print(sig_mods[[1]]$interaction_details)
```

}
\seealso{
\itemize{
\item \code{\link[mgm:mgm]{mgm::mgm()}} for core modeling function
\item \code{\link[bootnet:bootnet]{bootnet::bootnet()}} for alternative network bootstrap methods
}
}
\author{
Wang Fei, State Key Laboratory of Cognitive Neuroscience and Learning,
Beijing Normal University (2025-03-22)
}
